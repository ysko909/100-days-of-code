# 100 Days Of Code - 学習ログ

## 2020年10月分

### 1日目: 2020年10月1日（木）

**今日の進捗**:

- JavaScriptでローカルの画像をアップロードし、canvas上に表示するプログラムを作成。HTMLとJavaScriptなので、PlayCode上にて仮実装。
- [参考元URL](https://www.tam-tam.co.jp/tipsnote/javascript/post13538.html)では、画像ファイルであれば受け付けていたが、ここではPNGのみを対象とした。`type.match()`の対象を、`image/png`とするとPNGに限定できる。
- もともとの仕様では画像がアップロードされた場合のみcanvasの更新を行っていたため、対象外のファイルがアップロードされた場合は、過去にアップロードされたデータや子要素が画面に残り続ける。それを解消するため、PNG以外がアップロードされた場合は一度canvasを削除する仕様とした。また、同様にダウンロード用URLが存在する場合は子要素から削除する。

**思ったこと**: 

- PlayCodeは特定のボタンを押すと、ソースのフォーマットを行ってくれる。その際、アロー関数に引数がある場合は**かっこを外す**（引数がない場合はかっこを省略できないので、そのまま残る）。「挙動は一緒なんだから、文字は少ない方がいいでしょ」という判断なのかもしれないが、個人的にはまだアロー関数に慣れてないので、あんまり省略されると混乱する。
- アロー関数ではかっこだけでなく、1行で記述する場合は波かっこまで省略可能なので、ぱっと見の可読性に難があって割と混乱しがち。
- どっちがいいかはともかくとして、「どっちでも読める」程度には慣れたい。

**リンク** 

1. [File APIとCanvasでローカルの画像をアップロード→加工→ダウンロードする](https://www.tam-tam.co.jp/tipsnote/javascript/post13538.html)
1. [ソースのgist](https://gist.github.com/ysko909/0f14a71c5604ded658e3a4f8fb837e6d)

### 2日目: 2020年10月2日（金）

**今日の進捗**: 

- Pythonで`numpy.poly1d()`を使った回帰線の描画がコケた。具体的には、エラーにならず描画されないという感じ。
- 原因は`numpy.poly1d()`で渡したデータ群に欠損値があったこと。欠損値が存在している場合、エラーなどのリアクションをせず、ただ描画しないらしい。
- ちなみに何が欠損していたかというと、標準偏差を格納していた列の値の数データが欠損。理由は、標準偏差を算出する元のデータが1件しか存在しなかったため、「標準偏差を算出できないよ」と欠損していた。
- `dropna(subset=['col_name', 'col_name2'])`で欠損値を削除したデータを、`numpy.poly1d()`に渡して事なきを得た。

**思ったこと**: 

- エラーメッセージなんかのリアクションがないのに、望んだ結果が出力されないってのが一番困る。今回は、`numpy.poly1d()`の結果が`[nan, nan, nan, nan]`になってるのを`print`デバッグして見つけた。今回は手っ取り早く`print`したけど、vscodeのデバッグ機能を使ったデバッグもやっておこう。
- 入力のデータから欠損値を`drop`するのはもちろんありだが、「入力値が有限数か？（無限やNaNではないか）」を確認する方法もある。

```python
>>> import math
>>> hoge = [0, math.inf, 1.1, -0.35323432, -math.inf, float('nan')]
>>> list(map(lambda x: math.isfinite(x), hoge))
[True, False, True, True, False, False]
```

- `math.isfinite()`を利用すると、引数が有理数か否かを判断できる。このとき、`map()`でラムダ式を書き、イテレータの要素すべてに対し処理を行うと、要素が有理数か否かをブール値で返すので、これに基づき処理対象を決める方法もある。

```python
idx = np.isfinite(x) & np.isfinite(y)
ab = np.polyfit(x[idx], y[idx], 1)
```

- 考えてみたら当たり前だが、**標準偏差は算出元のデータが1つしかないなら算出できない**。複数のデータのうち、ばらつきがどれだけあるかを見る数値なのだから、当たり前だなー。

**リンク**

1. [matplotlibで描画した散布図に線形回帰直線を追加する方法](https://ja.stackoverflow.com/questions/38755/matplotlib%E3%81%A7%E6%8F%8F%E7%94%BB%E3%81%97%E3%81%9F%E6%95%A3%E5%B8%83%E5%9B%B3%E3%81%AB%E7%B7%9A%E5%BD%A2%E5%9B%9E%E5%B8%B0%E7%9B%B4%E7%B7%9A%E3%82%92%E8%BF%BD%E5%8A%A0%E3%81%99%E3%82%8B%E6%96%B9%E6%B3%95)
2. [numpy.polyfit doesn't handle NaN values](https://stackoverflow.com/questions/28647172/numpy-polyfit-doesnt-handle-nan-values)

### 3日目: 2020年10月4日（日）

**今日の進捗**: 

- p5.jsによるボタンの生成。`createButton()`を使うと、動的にボタンを生成できる。

```javascript
let button;

function setup() {
    createCanvas(400, 300);
    button = createButton('hoge');
    background(50);
}

function draw() {

}
```

- 上記のコードでは、実行するとCanvas外にボタンが1つ生成される。なお、これだけだと押してもボタンに挙動が設定されていないため、動作はしない。

```javascript
let button;

const drawRect = () => {
  fill(random(255));
  rect(random() * width, random() * height, random(width), random(height));
}

function setup(){
  createCanvas(400, 300);
  
  button = createButton('draw rectangle');
  button.mousePressed(drawRect);
}

function draw(){
  
}

```

- ボタンに挙動を設定するには、生成したボタンにアクションすべきイベントと挙動を指定する必要がある。上記のコードだと、`button.mousePressed(drawRect);`がその部分に当たる。

```javascript
let buttonDraw, buttonDel;

const drawRect = () => {
  fill(random(255));
  rect(random() * width, random() * height, random(width), random(height));
}

const clearCanvas = () => {
  background(255);
}

function setup(){
  createCanvas(400, 300);
  background(255);
  
  buttonDraw = createButton('draw rectangle');
  buttonDraw.mousePressed(drawRect);
  
  buttonDel = createButton('delete');
  buttonDel.mouseOver(clearCanvas);
}

function draw(){
  
}

```

- ボタンは複数生成が可能で、もちろんそれぞれについてアクションすべきイベントや機能を個別に設定できる。

**思ったこと**: 

- HTMLに書かなくてもJS側で動的に生成できるのは、編集する資産を一本化できるので便利。

**リンク**

1. [12_1：コントロール要素 Creative Coding p5.j](https://himco.jp/2019/03/25/12_1%EF%BC%9A%E3%82%B3%E3%83%B3%E3%83%88%E3%83%AD%E3%83%BC%E3%83%AB%E8%A6%81%E7%B4%A0-creative-coding-javascrip/)

### 3日目: 2020年10月3日（土）

**今日の進捗**: 

-

**思ったこと**: 

-

**リンク**

1. [hoge]()
